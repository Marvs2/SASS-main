{% extends "student/layout.html" %}
{% block content %}

<h1>Metadata Details</h1>

<input type="number" id="metadataIdInput" placeholder="Enter Metadata ID">
<button onclick="fetchMetadataDetails()">Get Details</button>

<table id="metadataDetailsTable">
    <thead>
        <tr>
            <th>Key</th>
            <th>Value</th>
        </tr>
    </thead>
    <tbody>
        <!-- Data will be populated here -->
    </tbody>
</table>
<script>
    const api_base_url = '{{ api_base_url | default("") }}';
    console.log('api_base_url: ', api_base_url);

async function fetchMetadataDetails() {
    const metadataId = document.getElementById("metadataIdInput").value;
    if (!metadataId) {
        alert("Please enter a Metadata ID");
        return;
    }

    try {
        const response = await fetch(`${api_base_url}/api/get_metadata_details/${MetadataId}`);

        if (!response.ok) {
            throw new Error(`Failed to fetch data. Server returned ${response.status}`);
        }

        const metadataDetails = await response.json();

        if (metadataDetails.error) {
            alert(metadataDetails.error);
            return;
        }

        displayMetadataDetails(metadataDetails);
    } catch (error) {
        console.error('Error fetching metadata details:', error.message);
        alert('Error fetching metadata details. Check the console for more information.');
    }
}

function displayMetadataDetails(data) {
    const tableBody = document.getElementById("metadataDetailsTable").querySelector("tbody");
    tableBody.innerHTML = ''; // Clear existing rows

    Object.entries(data).forEach(([key, value]) => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${key}</td><td>${value}</td>`;
        tableBody.appendChild(row);
    });
}

</script>
{% endblock %}
